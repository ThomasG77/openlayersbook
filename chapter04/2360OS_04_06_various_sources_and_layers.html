<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Playing with various sources and layers</title>
    <link rel="stylesheet" href="../assets/ol3/css/ol.css" type="text/css" />
    <link rel="stylesheet" href="../assets/css/samples.css" type="text/css" />
  </head>
  <body>
    <div id="map" class="map"></div>
    <script src="../assets/ol3/js/ol.js"></script>
    <script>
    var bingMapKey = 'your_own_bing_map_key';

    var bingMapsAerial = new ol.layer.Tile({
      preload: Infinity,
      source: new ol.source.BingMaps({
        key: bingMapKey,
        imagerySet: 'Aerial'
      })
    });

    bingMapsAerial.set('name', 'Bings Maps Aerial');

    var bingMapsRoad = new ol.layer.Tile({
      preload: Infinity,
      source: new ol.source.BingMaps({
        key: bingMapKey,
        imagerySet: 'Road',
        culture: 'fr-FR'
      })
    });

    bingMapsRoad.set('name', 'Bings Maps Road');

    var opentopomap = new ol.layer.Tile({
      source: new ol.source.XYZ({
        url: 'http://{a-c}.tile.opentopomap.org/{z}/{x}/{y}.png'
      })
    });

    opentopomap.set('name', 'OpenTopoMap');

    var simpleWMS = new ol.layer.Image({
          opacity: 0.6,
      source: new ol.source.ImageWMS({
        url: 'https://ahocevar.com/geoserver/wms',
        params: {'LAYERS': 'ne:ne'},
        serverType: 'geoserver',
        crossOrigin: 'anonymous'
      })
    });
    simpleWMS.set('name', 'World Maps from Geoserver WMS demo');

    var layers = [bingMapsAerial, bingMapsRoad, opentopomap, simpleWMS];

    var map = new ol.Map({
      layers: layers,
      target: 'map',
      view: new ol.View({
        center: ol.proj.fromLonLat([-90, 40]),
        zoom: 3
      })
    });

    //Generate checkbox from layers array
    function generate_checkbox(id_checkbox, label_name, html_element) {
      var checkbox = document.createElement('input');
      checkbox.type = "checkbox";
      checkbox.id = id_checkbox;

      var label = document.createElement('label');
      label.htmlFor = id_checkbox;
      label.appendChild(document.createTextNode(label_name));
      html_element.appendChild(checkbox);
      html_element.appendChild(label);
    }

    function addCheckBoxEvent(checkbox, layer) {
      checkbox.addEventListener('change', function() {
        var checked = this.checked;
        if (checked !== layer.getVisible()) {
          layer.setVisible(checked);
        }
      });

      if (layer.getVisible()) {
        checkbox.checked = layer.getVisible();
      }

      layer.on('change:visible', function() {
        var visible = this.getVisible();
        if (visible !== checkbox.checked) {
          checkbox.checked = visible;
        }
      });
    }

    // Loop from the end to get the top layer in first
    for (var i = layers.length - 1; i >= 0; i--) {
      var id = layers[i].get('id');
      var name = layers[i].get('name');
      generate_checkbox('layer_id_' + i, name, document.body);

      addCheckBoxEvent(document.getElementById('layer_id_' + i), layers[i]);
    }

    </script>
  </body>
</html>